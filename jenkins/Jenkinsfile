node {
    checkout scm
    stage('node setup'){
        steps {
            sh './gradlew nodeSetup'
            sh './gradlew npmSetup'
            echo 'node --version'
            echo 'npm --version'
            sh 'npm --version'
        }
    }
    stage('compile') {
        parallel(
            java: {
                sh './gradlew clean build'
            },
            npm: {
                sh './gradlew npmInstall'
            }
        )
    }
    stage('test') {
        parallel(
            jUnit: {
                sh './gradlew test'
            },
            jest: {
                sh './gradlew npmTest'
            }
        )
    }
    stage('build webapp') {
        sh './gradlew npmProd'
    }
    stage('deployment') {
        echo 'deployment'
    }
}